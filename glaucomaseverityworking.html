<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glaucoma Effect</title>
    <style>
        #image-container {
            position: relative;
            display: inline-block;
        }
        #uploaded-image {
            max-width: 100%;
            height: auto;
        }
        .glaucoma-effect {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            mask-image: radial-gradient(circle, transparent 25%, black 25%);
            -webkit-mask-image: radial-gradient(circle, transparent 25%, black 25%);
            z-index: 1;
            pointer-events: none;
        }
        .slidecontainer {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Glaucoma Effect on Image</h1>

    <!-- File upload form -->
    <input type="file" id="file-input" accept="image/*">

    <div id="image-container">
        <img id="uploaded-image" src="" alt="Uploaded Image">
        <div class="glaucoma-effect" id="glaucoma-effect"></div>
    </div>

    <center>
        <label for="myRange">You can change the severity of the glaucoma using the slider.</label>
    </center>

    <center>
        <div class="slidecontainer">
            <input type="range" min="1" max="100" value="1" class="slider" id="myRange">
            <p>Severity Level: <span id="severityText">Mild Severity</span></p>
        </div>
    </center>

    <script>
        // Get the file input, image, and effect elements
        const fileInput = document.getElementById('file-input');
        const uploadedImage = document.getElementById('uploaded-image');
        const glaucomaEffect = document.getElementById('glaucoma-effect');
        const slider = document.getElementById("myRange");
        const severityText = document.getElementById("severityText");

        // Slider severity levels
        const severityLevels = [
            { range: [1, 20], severity: "Mild Severity", clearCircleSize: 0.35 },
            { range: [21, 40], severity: "Moderate Severity", clearCircleSize: 0.30 },
            { range: [41, 60], severity: "High Severity", clearCircleSize: 0.25 },
            { range: [61, 80], severity: "Severe Glaucoma", clearCircleSize: 0.20 },
            { range: [81, 100], severity: "Extreme Severity", clearCircleSize: 0.15 },
        ];

        // Update the severity level based on the slider value
        function updateSeverity() {
            let severity = "None";
            let clearCircleSize = 0.35; // Default size

            for (let level of severityLevels) {
                if (slider.value >= level.range[0] && slider.value <= level.range[1]) {
                    severity = level.severity;
                    clearCircleSize = level.clearCircleSize;
                    break;
                }
            }

            // Update the severity text
            severityText.innerText = severity;

            // Resize the clear circle based on severity
            updateGlaucomaEffect(clearCircleSize);
        }

        // Function to update the glaucoma effect based on circle size
        function updateGlaucomaEffect(clearCircleSize) {
            if (uploadedImage.src) {
                const width = uploadedImage.width;
                const height = uploadedImage.height;

                // Apply the clear circle size as a percentage of the image's dimensions
                const clearCircleDiameter = Math.min(width, height) * clearCircleSize;

                glaucomaEffect.style.width = `${width}px`;
                glaucomaEffect.style.height = `${height}px`;
                glaucomaEffect.style.maskImage = `radial-gradient(circle, transparent ${clearCircleDiameter}px, black ${clearCircleDiameter}px)`;
                glaucomaEffect.style.webkitMaskImage = `radial-gradient(circle, transparent ${clearCircleDiameter}px, black ${clearCircleDiameter}px)`;
                glaucomaEffect.style.maskPosition = 'center';
                glaucomaEffect.style.webkitMaskPosition = 'center';
            }
        }

        // Initialize the effect when the image is loaded
        fileInput.addEventListener('change', function (e) {
            const file = e.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();

                reader.onload = function (event) {
                    uploadedImage.src = event.target.result;
                    uploadedImage.style.display = 'block';

                    // Wait for the image to load before applying the glaucoma effect
                    uploadedImage.onload = function () {
                        updateSeverity(); // Initialize the effect based on the initial slider value
                    };
                };

                reader.readAsDataURL(file);
            } else {
                alert("Please select a valid image file.");
            }
        });

        // Call updateSeverity when the slider changes
        slider.oninput = updateSeverity;

        // Initial setup
        updateSeverity();
    </script>
</body>
</html>
